#include "lp_filter.h"

#define BLOCK_SIZE				1									/*	调用一次arm_fir_f32处理的采样点数	*/
#define NUM_TAPS				61									/*	滤波器系数个数	*/

uint32_t	my_fblockSize = BLOCK_SIZE;

static	float32_t firStateF32[BLOCK_SIZE + NUM_TAPS - 1]; 			/*	状态缓存，大小numTaps + blockSize - 1*/

/* 低通滤波器系数 通过fdatool获取*/
const	float32_t firCoeffs32LP[NUM_TAPS] = {
	-0.003789262613f,	-0.003306990722f,	-0.002690281719f,	-0.001934816828f,	-0.001038181363f,\
	1.080327658e-18f,	0.00117796089f, 	0.002491725609f, 	0.003935080022f, 	0.005499581341f,\
	0.007174607366f, 	0.008947446942f,  	0.01080342941f,  	0.01272609271f,  	0.01469738502f,
    0.01669790223f,  	0.01870714873f,  	0.02070383728f,  	0.02266618237f,   	0.0245722346f,
    0.02640021034f,  	0.02812882513f,  	0.02973762341f,  	0.03120730631f,  	0.03252003342f,
    0.03365970775f,  	0.03461224213f,  	0.03536577895f,  	0.03591088951f,  	0.03624072671f,
    0.03635113686f,  	0.03624072671f,  	0.03591088951f,  	0.03536577895f,  	0.03461224213f,
    0.03365970775f,  	0.03252003342f,  	0.03120730631f,  	0.02973762341f,  	0.02812882513f,
    0.02640021034f,   	0.0245722346f,  	0.02266618237f,  	0.02070383728f,  	0.01870714873f,
    0.01669790223f,  	0.01469738502f,  	0.01272609271f,  	0.01080342941f, 	0.008947446942f,
	0.007174607366f, 	0.005499581341f, 	0.003935080022f, 	0.002491725609f,  	0.00117796089f,
	1.080327658e-18f,	-0.001038181363f,	-0.001934816828f,	-0.002690281719f,	-0.003306990722f,
	-0.003789262613f	};

/*	声明一个实体		*/
arm_fir_instance_f32 my_fS;
/*
*********************************************************************************************************
* 设 计 者：王远，常州赛乐医疗技术有限公司
* 版	  本：V1.0
* 日    期：2021-09-09
* 函 数 名: filterdesign_Init
* 功能说明: 麻醉处理流程
* 形    参: 

* 返 回 值: 
*********************************************************************************************************
*/
void lp_filter_Init(void)
{	
	/* 初始化结构体S */
	arm_fir_init_f32(&my_fS, NUM_TAPS, (float32_t *)&firCoeffs32LP[0], &firStateF32[0], my_fblockSize);
}

